@prefix owl: <http://www.w3.org/2002/07/owl#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-syntax-ns#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix prov: <http://www.w3.org/ns/prov#> .
@prefix dcterms: <http://purl.org/dc/terms/> .
@prefix agentictrust: <https://www.agentictrust.io/ontology/agentictrust-core#> .
@prefix agentictrustEth: <https://www.agentictrust.io/ontology/agentictrust-eth#> .
@prefix erc8092: <https://www.agentictrust.io/ontology/ERC8092#> .

agentictrustEth: a owl:Ontology ;
  dcterms:title "AgenticTrustEthOntology" ;
  dcterms:description "Ethereum-specific extensions to AgenticTrust core ontology: Account (realization of Identifier) and ENS Name (realization of Name). Maps to ERC-8004 and ERC-8092." ;
  owl:imports <https://www.agentictrust.io/ontology/agentictrust-core> ;
  owl:imports <http://www.w3.org/ns/prov-o#> ;
  owl:versionInfo "0.1.0" ;
  dcterms:license <https://opensource.org/license/mit/> .

########
# Ethereum Account
########

agentictrustEth:Account a owl:Class ;
  rdfs:label "Account" ;
  rdfs:comment "Ethereum account (EOA or Smart Account) identified by chainId and address. Contains account-specific properties (address, chainId, accountType). Modeled as prov:SoftwareAgent to support participant references in relationships." ;
  rdfs:subClassOf prov:SoftwareAgent .

########
# Account Identifier (realization of Identifier)
########

agentictrustEth:AccountIdentifier a owl:Class ;
  rdfs:label "AccountIdentifier" ;
  rdfs:comment "Identifier for an Ethereum Account. Links to its DID via hasDID. The underlying Account entity links to this identifier via agentictrustEth:hasIdentifier (inverse traversal can be expressed in SPARQL as ^agentictrustEth:hasIdentifier)." ;
  rdfs:subClassOf agentictrust:Identifier ;
  rdfs:subClassOf prov:Entity .

########
# Ethereum Account Properties
########

agentictrustEth:accountChainId a owl:DatatypeProperty ;
  rdfs:label "accountChainId" ;
  rdfs:comment "EVM chain ID where the account exists (e.g., 1 for mainnet, 11155111 for Sepolia)." ;
  rdfs:domain agentictrustEth:Account ;
  rdfs:range xsd:integer .

agentictrustEth:accountAddress a owl:DatatypeProperty ;
  rdfs:label "accountAddress" ;
  rdfs:comment "Ethereum account address (0x-prefixed hex string, 42 characters)." ;
  rdfs:domain agentictrustEth:Account ;
  rdfs:range xsd:string .

agentictrustEth:accountType a owl:DatatypeProperty ;
  rdfs:label "accountType" ;
  rdfs:comment "Account type: 'EOA' (Externally Owned Account) or 'SmartAccount' (contract-based account)." ;
  rdfs:domain agentictrustEth:Account ;
  rdfs:range xsd:string .

agentictrustEth:AccountType a owl:Class ;
  rdfs:label "AccountType" ;
  rdfs:comment "Ethereum account type enumeration (EOA or SmartAccount)." ;
  rdfs:subClassOf prov:Entity .

agentictrustEth:AccountType_EOA a agentictrustEth:AccountType ; rdfs:label "EOA" .
agentictrustEth:AccountType_SmartAccount a agentictrustEth:AccountType ; rdfs:label "SmartAccount" .

########
# Account to AccountIdentifier relationship
########

# Note: Account inherits hasIdentifier from prov:Agent (defined in agentictrust-core.owl)
# Account uses agentictrust:hasIdentifier to link to its AccountIdentifier

########
# AccountIdentifier DID
########


########
# Account Signing Authority
########

agentictrustEth:hasEOAOwner a owl:ObjectProperty ;
  rdfs:label "hasEOAOwner" ;
  rdfs:comment "Links an Ethereum Account to its EOA owner account (for signatures). The EOA is the signing authority; all messages come from the EOA. The Account validates signatures from this EOA." ;
  rdfs:domain agentictrustEth:Account ;
  rdfs:range agentictrustEth:Account .

agentictrustEth:validatesSignature a owl:ObjectProperty ;
  rdfs:label "validatesSignature" ;
  rdfs:comment "Links an Ethereum Account to signature validation capabilities. The Account validates ECDSA signatures from its EOA owner." ;
  rdfs:domain agentictrustEth:Account ;
  rdfs:range agentictrust:VerificationMethod .

agentictrustEth:signingAuthority a owl:ObjectProperty ;
  rdfs:label "signingAuthority" ;
  rdfs:comment "Links an Ethereum Account to its signing authority (EOA Account). All messages come from this EOA signing authority." ;
  rdfs:domain agentictrustEth:Account ;
  rdfs:range agentictrustEth:Account .

########
# ENS Name (realization of Name)
########

agentictrustEth:AgentNameENS a owl:Class ;
  rdfs:label "AgentNameENS" ;
  rdfs:comment "Ethereum Name Service (ENS) name (e.g., alice.eth). Realizes agentictrust:AgentName for Ethereum-based agents. Modeled as prov:Entity." ;
  rdfs:subClassOf agentictrust:AgentName ;
  rdfs:subClassOf prov:Entity .

########
# ENS Name Properties
########

agentictrustEth:ensName a owl:DatatypeProperty ;
  rdfs:label "ensName" ;
  rdfs:comment "ENS name string (e.g., 'alice.eth')." ;
  rdfs:domain agentictrustEth:AgentNameENS ;
  rdfs:range xsd:string .

# Note: AgentNameENS does not inherit from Agent, so it does not have hasIdentifier.
# AgentNameENS is an AgentName entity, not an Agent.

agentictrustEth:ensChainId a owl:DatatypeProperty ;
  rdfs:label "ensChainId" ;
  rdfs:comment "Chain ID where the ENS name is registered (typically mainnet, chain ID 1)." ;
  rdfs:domain agentictrustEth:AgentNameENS ;
  rdfs:range xsd:integer .

agentictrustEth:ensResolvesTo a owl:ObjectProperty ;
  rdfs:label "ensResolvesTo" ;
  rdfs:comment "Links an ENS name to the Account it resolves to." ;
  rdfs:domain agentictrustEth:AgentNameENS ;
  rdfs:range agentictrustEth:Account .

agentictrustEth:ensController a owl:ObjectProperty ;
  rdfs:label "ensController" ;
  rdfs:comment "Links an ENS name to the Account that controls it (can update/resolve the name)." ;
  rdfs:domain agentictrustEth:AgentNameENS ;
  rdfs:range agentictrustEth:Account .

########
# Agent to Account/ENS Name relationships
########

agentictrustEth:hasAccountIdentifier a owl:ObjectProperty ;
  rdfs:label "hasAccountIdentifier" ;
  rdfs:comment "Links an agent to its Ethereum AccountIdentifier (realization of agentictrust:hasIdentifier via AccountIdentifier). Each Agent has one associated AccountIdentifier." ;
  rdfs:domain agentictrust:AIAgent ;
  rdfs:range agentictrustEth:AccountIdentifier .

###
# NOTE: replaced by agentictrust:hasName (prov:Agent â†’ agentictrust:AgentName),
# where the concrete name instance is an agentictrustEth:AgentNameENS.
###

########
# Account Relationship (Account-to-Account relationships)
########
# Account Relationship Properties
########

agentictrustEth:hasAccountRelationshipAssertion a owl:ObjectProperty ;
  rdfs:label "hasAccountRelationshipAssertion" ;
  rdfs:comment "Links an Account to ERC-8092 trust assertions (erc8092:TrustAssertion) it participates in or produces (for Account-to-Account relationships)." ;
  rdfs:domain agentictrustEth:Account ;
  rdfs:range erc8092:TrustAssertion .

########
# Descriptors
########

agentictrustEth:AccountDescriptor a owl:Class ;
  rdfs:label "AccountDescriptor" ;
  rdfs:comment "Descriptor for an Ethereum Account identifier/entity (resolved chainId/address, account type, signing authority, and validation capabilities)." ;
  rdfs:subClassOf agentictrust:IdentifierDescriptor .

agentictrustEth:NameIdentifierENS a owl:Class ;
  rdfs:label "NameIdentifierENS" ;
  rdfs:comment "ENS (Ethereum Name Service) name identifier. Represents a human-readable ENS name (e.g., agent.eth) that resolves to an Ethereum address. Valid ENS names end with .eth." ;
  rdfs:subClassOf agentictrust:Identifier ;
  rdfs:subClassOf prov:Entity .

agentictrustEth:IdentifierType_account a agentictrust:IdentifierType ;
  rdfs:label "account" ;
  rdfs:comment "Ethereum account identifier type." .

agentictrustEth:IdentifierType_ens a agentictrust:IdentifierType ;
  rdfs:label "ens" ;
  rdfs:comment "ENS name identifier type." .

agentictrustEth:AgentNameENSDescriptor a owl:Class ;
  rdfs:label "AgentNameENSDescriptor" ;
  rdfs:comment "Descriptor for an ENS name (resolved name, chain, resolver/controller, and resolution targets)." ;
  rdfs:subClassOf agentictrust:AgentNameDescriptor .

